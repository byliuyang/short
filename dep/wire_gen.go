// Code generated by Wire. DO NOT EDIT.

//go:generate wire
//+build !wireinject

package dep

import (
	"database/sql"
	"short/app/adapter/github"
	"short/app/usecase/keygen"
	"short/app/usecase/requester"
	"short/dep/inject"

	"github.com/byliuyang/app/modern/mdhttp"
	"github.com/byliuyang/app/modern/mdlogger"
	"github.com/byliuyang/app/modern/mdrequest"
	"github.com/byliuyang/app/modern/mdrouting"
	"github.com/byliuyang/app/modern/mdservice"
	"github.com/byliuyang/app/modern/mdtimer"
	"github.com/byliuyang/app/modern/mdtracer"
)

// Injectors from wire.go:

func InitGraphQlService(name string, db *sql.DB, graphqlPath inject.GraphQlPath, secret inject.ReCaptchaSecret, jwtSecret inject.JwtSecret) mdservice.Service {
	logger := mdlogger.NewLocal()
	tracer := mdtracer.NewLocal()
	url := inject.URLRepoSQL(db)
	retriever := inject.URLRetrieverPersist(url)
	userURL := inject.UserURLRepoSQL(db)
	keyGenerator := keygen.NewInMemory()
	creator := inject.URLCreatorPersist(url, userURL, keyGenerator)
	client := mdhttp.NewClient()
	httpRequest := mdrequest.NewHTTP(client)
	reCaptcha := inject.ReCaptchaService(httpRequest, secret)
	verifier := requester.NewVerifier(reCaptcha)
	cryptoTokenizer := inject.JwtGo(jwtSecret)
	timer := mdtimer.NewTimer()
	authenticator := inject.Authenticator(cryptoTokenizer, timer)
	graphQlAPI := inject.ShortGraphQlAPI(logger, tracer, retriever, creator, verifier, authenticator)
	server := inject.GraphGophers(graphqlPath, logger, tracer, graphQlAPI)
	service := mdservice.New(name, server, logger)
	return service
}

func InitRoutingService(name string, db *sql.DB, wwwRoot inject.WwwRoot, githubClientID inject.GithubClientID, githubClientSecret inject.GithubClientSecret, jwtSecret inject.JwtSecret) mdservice.Service {
	logger := mdlogger.NewLocal()
	tracer := mdtracer.NewLocal()
	timer := mdtimer.NewTimer()
	url := inject.URLRepoSQL(db)
	retriever := inject.URLRetrieverPersist(url)
	client := mdhttp.NewClient()
	httpRequest := mdrequest.NewHTTP(client)
	oauthGithub := inject.GithubOAuth(httpRequest, githubClientID, githubClientSecret)
	graphQlRequest := mdrequest.NewGraphQl(httpRequest)
	api := github.NewAPI(graphQlRequest)
	cryptoTokenizer := inject.JwtGo(jwtSecret)
	authenticator := inject.Authenticator(cryptoTokenizer, timer)
	user := inject.UserRepoSQL(db)
	account := inject.RepoAccount(user, timer)
	v := inject.ShortRoutes(logger, tracer, wwwRoot, timer, retriever, oauthGithub, api, authenticator, account)
	server := mdrouting.NewBuiltIn(logger, tracer, v)
	service := mdservice.New(name, server, logger)
	return service
}
